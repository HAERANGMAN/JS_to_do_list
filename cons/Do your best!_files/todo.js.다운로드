const toDoForm = document.getElementById("todo-form");
const toDoInput = toDoForm.querySelector("input");
const toDoList = document.getElementById("todo-list");
const doneList = document.getElementById("done-list");

//JSON.stringify() -> ìŠ¤íŠ¸ë§í™”
//JSON.parse() -> ì˜¤ë¸Œì íŠ¸í™”
////////////////////////////////////////////////////////////
//[SAVING]

//í•­ìƒ ìƒˆ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì¶œë°œí•˜ê¸° ë–„ë¬¸ì— ìƒˆë¡œê³ ì¹¨í•´ì„œ ì…ë ¥í•˜ë©´ ìƒˆë¡œì €ì¥ë¨
//ê·¸ë˜ì„œ ê¸°ì¡´ì˜ ê²ƒì„ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ constê°€ ì•„ë‹ˆë¼ letìœ¼ë¡œ ë°”ê¿ˆ
let toDos = [];
const TODOS_KEY = "todos";

function saveToDos() {
  localStorage.setItem(TODOS_KEY, JSON.stringify(toDos));
}

////////////////////////////////////////////////////////////
//[DELETING]
//eventëŠ” í•¨ìˆ˜ê°€ ì‚¬ìš©ë˜ì—ˆë˜ ì´ë²¤íŠ¸ì—ëŒ€í•œ ê°’ë“¤ì„ ì €ì¥í•˜ëŠ” ê²ƒ
function deleteTodoList(event) {
  const removeList = event.target.parentElement; //ì´ë²¤íŠ¸.íƒ€ê²Ÿí•˜ê¸°.ì´ë²¤íŠ¸ê°’ì¤‘íŒŒë ŒíŠ¸ì—˜ë¦¬ë¨¼íŠ¸
  removeList.style = "text-decoration:line-through";
  console.log(removeList);
  removeList.querySelector("button").innerText = "ğŸ¥";
  // removeList.removeList;
  doneList.appendChild(removeList);
  // removeList.querySelector("button").innerText("ğŸ¥");
  // toDos ë°°ì—´ì´ ê°€ì§„ ê°’ì— filterë¥¼ í†µí•´ ì‚­ì œë¥¼ ëˆ„ë¥¸ toDosì˜ idê°’ì„ ì œì™¸í•œ
  // ë‹¤ë¥¸ idë¥¼ ê°€ì§„ toDosëŠ” ìœ ì§€ì‹œì¼œì¤Œ
  toDos = toDos.filter((tomato) => tomato.id !== parseInt(removeList.id));
  saveToDos();
}
// list.filter(); // në²ˆì§¸ì— í•¨ìˆ˜ê°’ì´ ì ìš©ë˜ì–´ì„œë‚˜ì˜¨ê°’ì´ nê³¼ë™ì¼í•˜ë©´ ë¦¬ìŠ¤íŠ¸ì—ë‚¨ê¹€

////////////////////////////////////////////////////////////
//[ADDING]
//createElementì˜ ì‚¬ìš©!
function paintToDo(newToDo) {
  const new_li = document.createElement("li");
  new_li.id = newToDo.id;
  const new_span = document.createElement("span");
  new_span.innerText = newToDo.text;
  const btn = document.createElement("button");
  btn.innerText = "âœ…";
  btn.style = "margin: 0px 10px 3px 0px";
  btn.addEventListener("click", deleteTodoList);
  new_li.appendChild(btn);
  new_li.appendChild(new_span);
  toDoList.appendChild(new_li);
  console.log(new_li);
}

//eventëŠ” submitì´ë¼ëŠ” ì´ë²¤íŠ¸ì—ëŒ€í•œ ê°’ë“¤ì„ ì €ì¥í•˜ëŠ” ê²ƒ
//ì´ë²¤íŠ¸ ì¸ìë¥¼ ê°€ì ¸ì™€ì„œ ë¨¼ì € ìƒˆë¡œê³ ì¹¨ ì•ˆë˜ê¸° ë©ˆì¶°ë†“ê¸°
function handleToDoSubmit(event) {
  event.preventDefault();
  const newToDoInput = toDoInput.value; //ì¸í’‹ì€ ì—¬ê¸°ì„œ ì €ì¥ë¨
  toDoInput.value = ""; //ê·¸ë¦¬ê³  ê°’ì€ ë¦¬ì…‹
  const newToDoObj = {
    text: newToDoInput,
    id: Date.now(), //ì‹œê°„ì„ idê°’ìœ¼ë¡œ ì‚¬ìš©
  };
  toDos.push(newToDoObj); //appendê°€ pushì„
  paintToDo(newToDoObj);
  saveToDos();
}

toDoForm.addEventListener("submit", handleToDoSubmit);

const savedToDos = localStorage.getItem(TODOS_KEY);

if (savedToDos !== null) {
  const parsedToDos = JSON.parse(savedToDos);
  toDos = parsedToDos; //ë§Œì•½ localì— ê°’ì´ ìˆë‹¤ë©´ ë³€ìˆ˜ë¡œ ëŒë ¤ì¤Œ(ìƒˆë¡œê³ ì¹¨í•´ë„ ê¸°ì¡´ê°’ì €ì¥ìœ„í•´)
  //arrow function : forë¬¸ì²˜ëŸ¼ ì‚¬ìš© itemì´ iê°€ ë¨
  //parsedToDos.forEach((item) => console.log("this is turn off item", item));
  //forEachë¥¼ í†µí•´ len(parsedToDos)ë§Œí¼ (í•¨ìˆ˜)ì‹¤í–‰
  parsedToDos.forEach(paintToDo);
}
